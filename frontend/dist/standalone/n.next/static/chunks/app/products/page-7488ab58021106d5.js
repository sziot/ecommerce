(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[286],{9018:function(e,s,t){Promise.resolve().then(t.bind(t,3998))},4794:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},2489:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9376:function(e,s,t){"use strict";var a=t(5475);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},3998:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return N}});var a=t(7437),r=t(2265),l=t(9376),n=t(7648),c=t(9820),i=t(2383),o=t(9763);let d=(0,o.Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),u=(0,o.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var h=t(1001);let m=(0,r.forwardRef)((e,s)=>{let{options:t,value:l,onChange:n,placeholder:c="请选择",className:i,allowClear:o=!1}=e,[m,x]=(0,r.useState)(!1),p=t.find(e=>e.value===l),f=e=>{null==n||n(e),x(!1)};return(0,a.jsxs)("div",{ref:s,className:"relative",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>x(!m),className:(0,h.cn)("flex items-center justify-between w-full h-10 px-3","border border-gray-300 rounded-md bg-white","text-sm text-left","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","transition-colors",i),children:[(0,a.jsx)("span",{className:p?"text-gray-900":"text-gray-400",children:(null==p?void 0:p.label)||c}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[o&&p&&(0,a.jsx)("span",{onClick:e=>{e.stopPropagation(),null==n||n("")},className:"text-gray-400 hover:text-gray-600 p-1",children:"\xd7"}),(0,a.jsx)(d,{className:"w-4 h-4 text-gray-400"})]})]}),m&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>x(!1)}),(0,a.jsx)("div",{className:"absolute z-20 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-auto",children:t.map(e=>(0,a.jsx)("div",{onClick:()=>f(e.value),className:(0,h.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","hover:bg-gray-100",e.value===l&&"bg-blue-50 text-blue-600"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:e.label}),e.value===l&&(0,a.jsx)(u,{className:"w-4 h-4"})]})},e.value))})]})]})});m.displayName="Select";let x=(0,o.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),p=(0,o.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var f=t(2381);function g(e){let{current:s,total:t,pageSize:r,onChange:l,showTotal:n}=e,c=Math.ceil(t/r);return(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[n&&(0,a.jsx)("span",{className:"text-sm text-gray-600 mr-4",children:n(t)}),(0,a.jsx)(f.z,{variant:"default",size:"sm",onClick:()=>l(s-1),disabled:1===s,children:(0,a.jsx)(x,{className:"w-4 h-4"})}),(()=>{let e=[];if(c<=5)for(let s=1;s<=c;s++)e.push(s);else if(s<=3){for(let s=1;s<=4;s++)e.push(s);e.push("..."),e.push(c)}else if(s>=c-2){e.push(1),e.push("...");for(let s=c-3;s<=c;s++)e.push(s)}else{e.push(1),e.push("...");for(let t=s-1;t<=s+1;t++)e.push(t);e.push("..."),e.push(c)}return e})().map((e,t)=>(0,a.jsx)("div",{children:"number"==typeof e?(0,a.jsx)(f.z,{variant:e===s?"primary":"default",size:"sm",onClick:()=>l(e),children:e},e):(0,a.jsx)("span",{className:"px-2 text-gray-400",children:e},e)},t)),(0,a.jsx)(f.z,{variant:"default",size:"sm",onClick:()=>l(s+1),disabled:s===c,children:(0,a.jsx)(p,{className:"w-4 h-4"})})]})}var j=t(4761),v=t(8057),b=t(6606);function y(){let e=(0,l.useSearchParams)(),[s,t]=(0,r.useState)(1),[o,d]=(0,r.useState)(e.get("search")||""),[u,h]=(0,r.useState)(""),[x,p]=(0,r.useState)("-created_at"),{data:f}=(0,b.QT)("/categories/",{immediate:!0}),{data:y,loading:N}=(0,b.QT)("/products/?".concat((()=>{let e=new URLSearchParams;return o&&e.append("search",o),u&&e.append("category",u),x&&e.append("ordering",x),e.append("page",s.toString()),e.toString()})()),{immediate:!0}),w=(null==y?void 0:y.results)||[],k=(null==y?void 0:y.count)||0,C=e=>{if(!e||!Array.isArray(e))return[];let s=[];return e.forEach(e=>{s.push(e),e.children&&(s=s.concat(C(e.children)))}),s},S=f?C(f):[];return(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"商品列表"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 mb-6",children:[(0,a.jsx)("div",{className:"flex-1 min-w-[200px] max-w-md",children:(0,a.jsx)(i.M,{placeholder:"搜索商品",onSearch:e=>{d(e),t(1)}})}),(0,a.jsx)(m,{placeholder:"选择分类",value:u,onChange:e=>{h(e),t(1)},allowClear:!0,options:S.map(e=>({label:"".concat(e.parent?"└ ":"").concat(e.name),value:e.id.toString()}))}),(0,a.jsx)(m,{placeholder:"排序方式",value:x,onChange:e=>{p(e),t(1)},options:[{label:"最新上架",value:"-created_at"},{label:"价格从低到高",value:"price"},{label:"价格从高到低",value:"-price"},{label:"销量优先",value:"-sales"}]})]})]}),N?(0,a.jsx)(j.h,{}):0===w.length?(0,a.jsx)(v.u,{title:"暂无商品",description:"没有找到匹配的商品"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:w.map(e=>(0,a.jsx)(n.default,{href:"/products/".concat(e.id),children:(0,a.jsxs)(c.Zb,{className:"hover:shadow-lg transition-shadow cursor-pointer h-full",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("img",{alt:e.name,src:e.main_image||"/placeholder-product.jpg",className:"w-full h-48 object-cover rounded-t-lg"}),e.discount_percent>0&&(0,a.jsxs)("span",{className:"absolute top-2 left-2 bg-red-500 text-white px-2 py-1 rounded text-xs",children:[e.discount_percent,"% OFF"]})]}),(0,a.jsxs)(c.aY,{className:"p-4",children:[(0,a.jsx)("h3",{className:"font-medium truncate mb-2",title:e.name,children:e.name}),(0,a.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,a.jsxs)("span",{className:"text-red-500 font-semibold text-lg",children:["\xa5",e.price]}),e.original_price&&(0,a.jsxs)("span",{className:"text-gray-400 line-through text-sm",children:["\xa5",e.original_price]})]}),(0,a.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["已售 ",e.sales," 件"]}),(0,a.jsx)("div",{className:"mt-1",children:e.stock>0?(0,a.jsx)("span",{className:"inline-block px-2 py-1 text-xs bg-green-100 text-green-700 rounded",children:"有货"}):(0,a.jsx)("span",{className:"inline-block px-2 py-1 text-xs bg-red-100 text-red-700 rounded",children:"缺货"})})]})]})},e.id))}),k>20&&(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsx)(g,{current:s,total:k,pageSize:20,onChange:e=>{t(e),window.scrollTo({top:0,behavior:"smooth"})},showTotal:e=>"共 ".concat(e," 件商品")})})]})]})}function N(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)(j.h,{}),children:(0,a.jsx)(y,{})})}},8057:function(e,s,t){"use strict";t.d(s,{u:function(){return l}});var a=t(7437),r=t(4794);function l(e){let{icon:s=(0,a.jsx)(r.Z,{className:"w-12 h-12"}),title:t="暂无数据",description:l,action:n}=e;return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:[(0,a.jsx)("div",{className:"text-gray-300 mb-4",children:s}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:t}),l&&(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:l}),n]})}},279:function(e,s,t){"use strict";t.d(s,{I:function(){return n}});var a=t(7437),r=t(2265),l=t(1001);let n=(0,r.forwardRef)((e,s)=>{let{className:t,type:r,error:n,label:c,id:i,...o}=e,d=i||(null==c?void 0:c.toLowerCase().replace(/\s+/g,"-"));return(0,a.jsxs)("div",{className:"w-full",children:[c&&(0,a.jsx)("label",{htmlFor:d,className:"block text-sm font-medium text-gray-700 mb-1",children:c}),(0,a.jsx)("input",{id:d,type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2","text-sm placeholder:text-gray-400","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","disabled:cursor-not-allowed disabled:opacity-50",n&&"border-red-500 focus:ring-red-500",t),ref:s,...o}),n&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:n})]})});n.displayName="Input"},2383:function(e,s,t){"use strict";t.d(s,{M:function(){return d}});var a=t(7437),r=t(2265);let l=(0,t(9763).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var n=t(2489),c=t(279),i=t(2381),o=t(1001);function d(e){let{placeholder:s="搜索...",onSearch:t,className:d}=e,[u,h]=(0,r.useState)(""),m=()=>{t(u)};return(0,a.jsxs)("div",{className:(0,o.cn)("relative flex items-center w-full",d),children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(l,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"}),(0,a.jsx)(c.I,{type:"text",value:u,onChange:e=>h(e.target.value),onKeyDown:e=>{"Enter"===e.key&&m()},placeholder:s,className:"pl-10 pr-10"}),u&&(0,a.jsx)("button",{type:"button",onClick:()=>{h(""),t("")},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:(0,a.jsx)(n.Z,{className:"h-4 w-4"})})]}),(0,a.jsx)(i.z,{type:"button",variant:"primary",onClick:m,className:"ml-2",children:"搜索"})]})}}},function(e){e.O(0,[482,648,61,971,117,744],function(){return e(e.s=9018)}),_N_E=e.O()}]);