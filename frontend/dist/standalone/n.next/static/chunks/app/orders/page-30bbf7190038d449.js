(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[569],{4472:function(e,s,t){Promise.resolve().then(t.bind(t,6004))},5302:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},2208:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},4794:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},340:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]])},2489:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9376:function(e,s,t){"use strict";var a=t(5475);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},6004:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return b}});var a=t(7437),c=t(2265),n=t(9376),l=t(9763);let r=(0,l.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var i=t(5302),d=t(340);let x=(0,l.Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var o=t(2208),m=t(2381),u=t(9820),h=t(6742),p=t(4761),j=t(8057),y=t(1217),f=t(6606),N=t(8249),g=t(1837);let v={pending:{color:"bg-orange-100 text-orange-700",icon:(0,a.jsx)(r,{className:"w-4 h-4"}),text:"待支付"},paid:{color:"bg-blue-100 text-blue-700",icon:(0,a.jsx)(i.Z,{className:"w-4 h-4"}),text:"已支付"},shipped:{color:"bg-cyan-100 text-cyan-700",icon:(0,a.jsx)(d.Z,{className:"w-4 h-4"}),text:"已发货"},completed:{color:"bg-green-100 text-green-700",icon:(0,a.jsx)(i.Z,{className:"w-4 h-4"}),text:"已完成"},cancelled:{color:"bg-red-100 text-red-700",icon:(0,a.jsx)(x,{className:"w-4 h-4"}),text:"已取消"}};function b(){let e=(0,n.useRouter)(),{isAuthenticated:s}=(0,y.t)(),[t,l]=(0,c.useState)(null),[r,i]=(0,c.useState)(!1),{data:d,loading:x}=(0,f.QT)("/orders/",{immediate:s});(0,c.useEffect)(()=>{s||e.push("/login")},[s,e]);let b=async e=>{try{await g.Z.post("/orders/".concat(e,"/cancel/")),N.A.success("订单已取消"),window.location.reload()}catch(e){N.A.error("取消失败")}},w=e=>{l(e),i(!0)};return s?x?(0,a.jsx)(p.h,{}):(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"我的订单"}),null===d?(0,a.jsx)(p.h,{}):0===d.length?(0,a.jsx)(u.Zb,{children:(0,a.jsx)(u.aY,{className:"p-12",children:(0,a.jsx)(j.u,{title:"暂无订单",description:"您还没有订单"})})}):(0,a.jsx)("div",{className:"space-y-4",children:d.map(s=>{let t=v[s.status];return(0,a.jsx)(u.Zb,{children:(0,a.jsxs)(u.aY,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["订单号：",s.order_no]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["下单时间：",new Date(s.created_at).toLocaleString("zh-CN")]})]}),(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs ".concat(t.color),children:[t.icon,t.text]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:s.items.slice(0,3).map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("img",{src:e.product_image||"/placeholder-product.jpg",alt:e.product_name,className:"w-16 h-16 object-cover rounded"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm truncate",children:e.product_name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["\xa5",e.price," x ",e.quantity]})]})]},e.id))}),(0,a.jsxs)("div",{className:"flex justify-between items-center border-t pt-4 flex-wrap gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["共 ",s.items.reduce((e,s)=>e+s.quantity,0)," 件商品"]}),(0,a.jsxs)("span",{className:"text-sm",children:["实付：",(0,a.jsxs)("span",{className:"text-red-500 font-semibold text-lg",children:["\xa5",s.actual_amount]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:["pending"===s.status&&(0,a.jsx)(m.z,{variant:"primary",size:"sm",onClick:()=>e.push("/payment?order_id=".concat(s.id)),children:"去支付"}),(0,a.jsxs)(m.z,{variant:"default",size:"sm",onClick:()=>w(s),children:[(0,a.jsx)(o.Z,{className:"w-4 h-4 mr-1"}),"查看详情"]}),"pending"===s.status&&(0,a.jsx)(m.z,{variant:"danger",size:"sm",onClick:()=>b(s.id),children:"取消订单"})]})]})]})},s.id)})}),(0,a.jsx)(h.u,{isOpen:r,onClose:()=>i(!1),title:"订单详情",size:"lg",children:t&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"订单号："}),(0,a.jsx)("span",{children:t.order_no})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"订单状态："}),(0,a.jsx)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs ".concat(v[t.status].color),children:v[t.status].text})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"下单时间："}),(0,a.jsx)("span",{children:new Date(t.created_at).toLocaleString("zh-CN")})]}),t.address&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"收货人："}),(0,a.jsxs)("span",{children:[t.address.receiver_name," ",t.address.receiver_phone]})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"收货地址："}),(0,a.jsxs)("span",{children:[t.address.province," ",t.address.city," ",t.address.district," ",t.address.detail]})]})]})]}),(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("h3",{className:"font-semibold mb-3",children:"费用明细"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"商品总额："}),(0,a.jsxs)("span",{children:["\xa5",t.total_amount]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"优惠："}),(0,a.jsxs)("span",{className:"text-red-500",children:["-\xa5",t.discount_amount]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"运费："}),(0,a.jsxs)("span",{children:["\xa5",t.shipping_fee]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-lg font-semibold",children:[(0,a.jsx)("span",{children:"实付金额："}),(0,a.jsxs)("span",{className:"text-red-500",children:["\xa5",t.actual_amount]})]})]})]}),(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("h3",{className:"font-semibold mb-3",children:"商品清单"}),(0,a.jsx)("div",{className:"space-y-3",children:t.items.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("img",{src:e.product_image||"/placeholder-product.jpg",alt:e.product_name,className:"w-16 h-16 object-cover rounded"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-medium",children:e.product_name}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["\xa5",e.price," x ",e.quantity]})]}),(0,a.jsxs)("span",{className:"font-semibold",children:["\xa5",e.subtotal]})]},e.id))})]})]})})]}):null}},8057:function(e,s,t){"use strict";t.d(s,{u:function(){return n}});var a=t(7437),c=t(4794);function n(e){let{icon:s=(0,a.jsx)(c.Z,{className:"w-12 h-12"}),title:t="暂无数据",description:n,action:l}=e;return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:[(0,a.jsx)("div",{className:"text-gray-300 mb-4",children:s}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:t}),n&&(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:n}),l]})}},6742:function(e,s,t){"use strict";t.d(s,{u:function(){return i}});var a=t(7437),c=t(2265),n=t(2489),l=t(1001);let r={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"};function i(e){let{isOpen:s,onClose:t,title:i,children:d,size:x="md",showCloseButton:o=!0}=e,m=(0,c.useRef)(null);return((0,c.useEffect)(()=>{let e=e=>{"Escape"===e.key&&s&&t()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[s,t]),(0,c.useEffect)(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[s]),s)?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:t}),(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,a.jsxs)("div",{ref:m,className:(0,l.cn)("relative bg-white rounded-lg shadow-xl w-full",r[x]),onClick:e=>e.stopPropagation(),children:[(i||o)&&(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[i&&(0,a.jsx)("h3",{className:"text-lg font-semibold",children:i}),o&&(0,a.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,a.jsx)(n.Z,{className:"w-5 h-5"})})]}),(0,a.jsx)("div",{className:"p-6",children:d})]})})]}):null}}},function(e){e.O(0,[482,61,971,117,744],function(){return e(e.s=4472)}),_N_E=e.O()}]);