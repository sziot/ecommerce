(()=>{var e={};e.id=286,e.ids=[286],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},2694:e=>{"use strict";e.exports=require("http2")},8791:e=>{"use strict";e.exports=require("https")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},4634:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>o}),t(7338),t(3324),t(5866);var r=t(3191),a=t(8716),l=t(7922),n=t.n(l),i=t(5231),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);t.d(s,c);let o=["",{children:["products",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,7338)),"/home/ubuntu/ecommerce/frontend/src/app/products/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,3324)),"/home/ubuntu/ecommerce/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/home/ubuntu/ecommerce/frontend/src/app/products/page.tsx"],u="/products/page",p={require:t,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/products/page",pathname:"/products",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},1686:(e,s,t)=>{Promise.resolve().then(t.bind(t,8200))},8200:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>N});var r=t(326),a=t(7577),l=t(5047),n=t(434),i=t(9752),c=t(640),o=t(6557);let d=(0,o.Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),u=(0,o.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var p=t(1867);let x=(0,a.forwardRef)(({options:e,value:s,onChange:t,placeholder:l="请选择",className:n,allowClear:i=!1},c)=>{let[o,x]=(0,a.useState)(!1),m=e.find(e=>e.value===s),h=e=>{t?.(e),x(!1)};return(0,r.jsxs)("div",{ref:c,className:"relative",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>x(!o),className:(0,p.cn)("flex items-center justify-between w-full h-10 px-3","border border-gray-300 rounded-md bg-white","text-sm text-left","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","transition-colors",n),children:[r.jsx("span",{className:m?"text-gray-900":"text-gray-400",children:m?.label||l}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[i&&m&&r.jsx("span",{onClick:e=>{e.stopPropagation(),t?.("")},className:"text-gray-400 hover:text-gray-600 p-1",children:"\xd7"}),r.jsx(d,{className:"w-4 h-4 text-gray-400"})]})]}),o&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>x(!1)}),r.jsx("div",{className:"absolute z-20 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-auto",children:e.map(e=>r.jsx("div",{onClick:()=>h(e.value),className:(0,p.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","hover:bg-gray-100",e.value===s&&"bg-blue-50 text-blue-600"),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{children:e.label}),e.value===s&&r.jsx(u,{className:"w-4 h-4"})]})},e.value))})]})]})});x.displayName="Select";let m=(0,o.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),h=(0,o.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var f=t(1664);function g({current:e,total:s,pageSize:t,onChange:a,showTotal:l}){let n=Math.ceil(s/t);return(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[l&&r.jsx("span",{className:"text-sm text-gray-600 mr-4",children:l(s)}),r.jsx(f.z,{variant:"default",size:"sm",onClick:()=>a(e-1),disabled:1===e,children:r.jsx(m,{className:"w-4 h-4"})}),(()=>{let s=[];if(n<=5)for(let e=1;e<=n;e++)s.push(e);else if(e<=3){for(let e=1;e<=4;e++)s.push(e);s.push("..."),s.push(n)}else if(e>=n-2){s.push(1),s.push("...");for(let e=n-3;e<=n;e++)s.push(e)}else{s.push(1),s.push("...");for(let t=e-1;t<=e+1;t++)s.push(t);s.push("..."),s.push(n)}return s})().map((s,t)=>r.jsx("div",{children:"number"==typeof s?r.jsx(f.z,{variant:s===e?"primary":"default",size:"sm",onClick:()=>a(s),children:s},s):r.jsx("span",{className:"px-2 text-gray-400",children:s},s)},t)),r.jsx(f.z,{variant:"default",size:"sm",onClick:()=>a(e+1),disabled:e===n,children:r.jsx(h,{className:"w-4 h-4"})})]})}var j=t(4055),v=t(988),b=t(1086);function y(){let e=(0,l.useSearchParams)(),[s,t]=(0,a.useState)(1),[o,d]=(0,a.useState)(e.get("search")||""),[u,p]=(0,a.useState)(""),[m,h]=(0,a.useState)("-created_at"),{data:f}=(0,b.QT)("/categories/",{immediate:!0}),{data:y,loading:N}=(0,b.QT)(`/products/?${(()=>{let e=new URLSearchParams;return o&&e.append("search",o),u&&e.append("category",u),m&&e.append("ordering",m),e.append("page",s.toString()),e.toString()})()}`,{immediate:!0}),w=y?.results||[],q=y?.count||0,C=e=>{if(!e||!Array.isArray(e))return[];let s=[];return e.forEach(e=>{s.push(e),e.children&&(s=s.concat(C(e.children)))}),s},_=f?C(f):[];return(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold mb-4",children:"商品列表"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-4 mb-6",children:[r.jsx("div",{className:"flex-1 min-w-[200px] max-w-md",children:r.jsx(c.M,{placeholder:"搜索商品",onSearch:e=>{d(e),t(1)}})}),r.jsx(x,{placeholder:"选择分类",value:u,onChange:e=>{p(e),t(1)},allowClear:!0,options:_.map(e=>({label:`${e.parent?"└ ":""}${e.name}`,value:e.id.toString()}))}),r.jsx(x,{placeholder:"排序方式",value:m,onChange:e=>{h(e),t(1)},options:[{label:"最新上架",value:"-created_at"},{label:"价格从低到高",value:"price"},{label:"价格从高到低",value:"-price"},{label:"销量优先",value:"-sales"}]})]})]}),N?r.jsx(j.h,{}):0===w.length?r.jsx(v.u,{title:"暂无商品",description:"没有找到匹配的商品"}):(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:w.map(e=>r.jsx(n.default,{href:`/products/${e.id}`,children:(0,r.jsxs)(i.Zb,{className:"hover:shadow-lg transition-shadow cursor-pointer h-full",children:[(0,r.jsxs)("div",{className:"relative",children:[r.jsx("img",{alt:e.name,src:e.main_image||"/placeholder-product.jpg",className:"w-full h-48 object-cover rounded-t-lg"}),e.discount_percent>0&&(0,r.jsxs)("span",{className:"absolute top-2 left-2 bg-red-500 text-white px-2 py-1 rounded text-xs",children:[e.discount_percent,"% OFF"]})]}),(0,r.jsxs)(i.aY,{className:"p-4",children:[r.jsx("h3",{className:"font-medium truncate mb-2",title:e.name,children:e.name}),(0,r.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,r.jsxs)("span",{className:"text-red-500 font-semibold text-lg",children:["\xa5",e.price]}),e.original_price&&(0,r.jsxs)("span",{className:"text-gray-400 line-through text-sm",children:["\xa5",e.original_price]})]}),(0,r.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["已售 ",e.sales," 件"]}),r.jsx("div",{className:"mt-1",children:e.stock>0?r.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-green-100 text-green-700 rounded",children:"有货"}):r.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-red-100 text-red-700 rounded",children:"缺货"})})]})]})},e.id))}),q>20&&r.jsx("div",{className:"mt-8",children:r.jsx(g,{current:s,total:q,pageSize:20,onChange:e=>{t(e),window.scrollTo({top:0,behavior:"smooth"})},showTotal:e=>`共 ${e} 件商品`})})]})]})}function N(){return r.jsx(a.Suspense,{fallback:r.jsx(j.h,{}),children:r.jsx(y,{})})}},9752:(e,s,t)=>{"use strict";t.d(s,{Ol:()=>i,Zb:()=>n,aY:()=>o,ll:()=>c});var r=t(326),a=t(7577),l=t(1867);let n=(0,a.forwardRef)(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,l.cn)("rounded-lg border border-gray-200 bg-white shadow-sm",e),...s}));n.displayName="Card";let i=(0,a.forwardRef)(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",e),...s}));i.displayName="CardHeader";let c=(0,a.forwardRef)(({className:e,...s},t)=>r.jsx("h3",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));c.displayName="CardTitle";let o=(0,a.forwardRef)(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,l.cn)("p-6 pt-0",e),...s}));o.displayName="CardContent"},988:(e,s,t)=>{"use strict";t.d(s,{u:()=>l});var r=t(326),a=t(8705);function l({icon:e=r.jsx(a.Z,{className:"w-12 h-12"}),title:s="暂无数据",description:t,action:l}){return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:[r.jsx("div",{className:"text-gray-300 mb-4",children:e}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:s}),t&&r.jsx("p",{className:"text-sm text-gray-500 mb-4",children:t}),l]})}},4055:(e,s,t)=>{"use strict";t.d(s,{h:()=>l});var r=t(326);function a({size:e="md"}){return r.jsx("div",{className:"flex items-center justify-center",children:r.jsx("div",{className:`border-4 border-gray-200 border-t-blue-600 rounded-full animate-spin ${{sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"}[e]}`})})}function l(){return r.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:r.jsx(a,{size:"lg"})})}},1086:(e,s,t)=>{"use strict";t.d(s,{ym:()=>n,iB:()=>i,QT:()=>l});var r=t(7577),a=t(8069);function l(e,s={}){let{immediate:t=!0,onSuccess:l,onError:n}=s,[i,c]=(0,r.useState)(null),[o,d]=(0,r.useState)(!1),[u,p]=(0,r.useState)(null),x=(0,r.useRef)(l),m=(0,r.useRef)(n),h=(0,r.useCallback)(async()=>{console.log("[useRequest] execute called for URL:",e),d(!0),p(null);try{let s=await a.Z.get(e);console.log("[useRequest] Got response:",s.data),c(s.data),console.log("[useRequest] Data set successfully"),x.current?.(s.data)}catch(e){console.error("[useRequest] Error:",e),p(e),m.current?.(e)}finally{console.log("[useRequest] Setting loading to false"),d(!1)}},[e]);return{data:i,loading:o,error:u,execute:h,refetch:h}}function n(){return l("/products/featured/")}function i(e){return l(`/products/${e}/`)}t(8029),t(3296)},7338:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(8570).createProxy)(String.raw`/home/ubuntu/ecommerce/frontend/src/app/products/page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[120,252],()=>t(4634));module.exports=r})();