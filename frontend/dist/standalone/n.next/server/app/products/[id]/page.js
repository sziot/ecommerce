(()=>{var e={};e.id=351,e.ids=[351],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},2694:e=>{"use strict";e.exports=require("http2")},8791:e=>{"use strict";e.exports=require("https")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},9052:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>o,routeModule:()=>p,tree:()=>d}),r(5607),r(3324),r(5866);var t=r(3191),a=r(8716),i=r(7922),n=r.n(i),l=r(5231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);r.d(s,c);let d=["",{children:["products",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,5607)),"/home/ubuntu/ecommerce/frontend/src/app/products/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,3324)),"/home/ubuntu/ecommerce/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],o=["/home/ubuntu/ecommerce/frontend/src/app/products/[id]/page.tsx"],u="/products/[id]/page",m={require:r,loadChunk:()=>Promise.resolve()},p=new t.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/products/[id]/page",pathname:"/products/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},6763:(e,s,r)=>{Promise.resolve().then(r.bind(r,7911))},1019:(e,s,r)=>{"use strict";r.d(s,{Z:()=>t});let t=(0,r(6557).Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},3855:(e,s,r)=>{"use strict";r.d(s,{Z:()=>t});let t=(0,r(6557).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7911:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>h});var t=r(326),a=r(7577),i=r(5047),n=r(1019),l=r(3855),c=r(7671),d=r(1664),o=r(9752),u=r(4055),m=r(1086),p=r(3296),x=r(4004);function h(){let e=(0,i.useParams)().id,{addToCart:s}=(0,p.x)(),[r,h]=(0,a.useState)(1),[g,f]=(0,a.useState)(0),{data:j,loading:b}=(0,m.iB)(e);if(b)return t.jsx(u.h,{});if(!j)return t.jsx("div",{className:"container mx-auto px-4 py-12",children:t.jsx("p",{className:"text-center text-gray-500",children:"商品不存在"})});let v=j.main_image?[{image:j.main_image}]:[],y=async()=>{try{await s(j.id,r),x.A.success("已加入购物车")}catch(e){x.A.error("加入购物车失败")}};return t.jsx("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[t.jsx("div",{children:(0,t.jsxs)(o.Zb,{children:[t.jsx("img",{src:v[g]?.image||j.main_image||"/placeholder-product.jpg",alt:j.name,className:"w-full rounded-t-lg"}),v.length>1&&t.jsx("div",{className:"p-4 grid grid-cols-5 gap-2",children:v.map((e,s)=>t.jsx("div",{className:`cursor-pointer border-2 rounded ${s===g?"border-blue-500":"border-transparent"}`,onClick:()=>f(s),children:t.jsx("img",{src:e.image,alt:`${j.name} ${s+1}`,className:"w-full h-20 object-cover rounded"})},s))})]})}),(0,t.jsxs)("div",{children:[t.jsx("h1",{className:"text-3xl font-bold mb-2",children:j.name}),t.jsx("p",{className:"text-gray-500 mb-4",children:j.category_name||""}),t.jsx("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("span",{className:"text-3xl text-red-500 font-semibold",children:["\xa5",j.price]}),j.original_price&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{className:"text-gray-400 line-through text-xl",children:["\xa5",j.original_price]}),(0,t.jsxs)("span",{className:"bg-red-500 text-white px-2 py-1 rounded text-sm",children:[j.discount_percent,"% OFF"]})]})]})}),(0,t.jsxs)("div",{className:"space-y-2 mb-6",children:[(0,t.jsxs)("p",{children:[t.jsx("span",{className:"font-semibold",children:"库存："}),t.jsx("span",{className:j.stock>0?"text-green-600":"text-red-600",children:j.stock>0?`${j.stock} 件`:"缺货"})]}),(0,t.jsxs)("p",{children:[t.jsx("span",{className:"font-semibold",children:"销量："}),(0,t.jsxs)("span",{children:[j.sales," 件"]})]})]}),(0,t.jsxs)("div",{className:"mb-6",children:[t.jsx("p",{className:"font-semibold mb-2",children:"数量："}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(d.z,{variant:"default",size:"sm",onClick:()=>h(Math.max(1,r-1)),disabled:r<=1,children:t.jsx(n.Z,{className:"w-4 h-4"})}),t.jsx("input",{type:"number",min:1,max:j.stock,value:r,onChange:e=>h(Math.max(1,Math.min(j.stock,parseInt(e.target.value)||1))),className:"w-16 text-center border rounded py-1"}),t.jsx(d.z,{variant:"default",size:"sm",onClick:()=>h(Math.min(j.stock,r+1)),disabled:r>=j.stock,children:t.jsx(l.Z,{className:"w-4 h-4"})})]})]}),(0,t.jsxs)(d.z,{variant:"primary",fullWidth:!0,size:"lg",disabled:0===j.stock,onClick:y,className:"mb-6",children:[t.jsx(c.Z,{className:"w-5 h-5 mr-2"}),j.stock>0?"加入购物车":"缺货"]}),(0,t.jsxs)("div",{className:"border-t pt-6",children:[t.jsx("h3",{className:"text-xl font-semibold mb-4",children:"商品描述"}),t.jsx("p",{className:"text-gray-600 whitespace-pre-wrap",children:j.description})]})]})]})})}},9752:(e,s,r)=>{"use strict";r.d(s,{Ol:()=>l,Zb:()=>n,aY:()=>d,ll:()=>c});var t=r(326),a=r(7577),i=r(1867);let n=(0,a.forwardRef)(({className:e,...s},r)=>t.jsx("div",{ref:r,className:(0,i.cn)("rounded-lg border border-gray-200 bg-white shadow-sm",e),...s}));n.displayName="Card";let l=(0,a.forwardRef)(({className:e,...s},r)=>t.jsx("div",{ref:r,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...s}));l.displayName="CardHeader";let c=(0,a.forwardRef)(({className:e,...s},r)=>t.jsx("h3",{ref:r,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));c.displayName="CardTitle";let d=(0,a.forwardRef)(({className:e,...s},r)=>t.jsx("div",{ref:r,className:(0,i.cn)("p-6 pt-0",e),...s}));d.displayName="CardContent"},4055:(e,s,r)=>{"use strict";r.d(s,{h:()=>i});var t=r(326);function a({size:e="md"}){return t.jsx("div",{className:"flex items-center justify-center",children:t.jsx("div",{className:`border-4 border-gray-200 border-t-blue-600 rounded-full animate-spin ${{sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"}[e]}`})})}function i(){return t.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:t.jsx(a,{size:"lg"})})}},1086:(e,s,r)=>{"use strict";r.d(s,{ym:()=>n,iB:()=>l,QT:()=>i});var t=r(7577),a=r(8069);function i(e,s={}){let{immediate:r=!0,onSuccess:i,onError:n}=s,[l,c]=(0,t.useState)(null),[d,o]=(0,t.useState)(!1),[u,m]=(0,t.useState)(null),p=(0,t.useRef)(i),x=(0,t.useRef)(n),h=(0,t.useCallback)(async()=>{console.log("[useRequest] execute called for URL:",e),o(!0),m(null);try{let s=await a.Z.get(e);console.log("[useRequest] Got response:",s.data),c(s.data),console.log("[useRequest] Data set successfully"),p.current?.(s.data)}catch(e){console.error("[useRequest] Error:",e),m(e),x.current?.(e)}finally{console.log("[useRequest] Setting loading to false"),o(!1)}},[e]);return{data:l,loading:d,error:u,execute:h,refetch:h}}function n(){return i("/products/featured/")}function l(e){return i(`/products/${e}/`)}r(8029),r(3296)},5607:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>t});let t=(0,r(8570).createProxy)(String.raw`/home/ubuntu/ecommerce/frontend/src/app/products/[id]/page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[120,252],()=>r(9052));module.exports=t})();